<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="JACUSA2helper">
<title>Analysis of DART-seq with JACUSA2helper • JACUSA2helper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of DART-seq with JACUSA2helper">
<meta property="og:description" content="JACUSA2helper">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">JACUSA2helper</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.9.9.9600</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/JACUSA2helper.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/JACUSA2helper-meta-conditions.html">Introduction to meta conditions with JACUSA2helper</a>
    <a class="dropdown-item" href="../articles/JACUSA2helper-dart-seq.html">Analysis of DART-seq with JACUSA2helper</a>
    <a class="dropdown-item" href="../articles/JACUSA2helper-mazf.html">Analysis of m6A mapping by MazF with JACUSA2helper</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dieterich-lab/JACUSA2helper/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analysis of DART-seq with JACUSA2helper</h1>
                        <h4 data-toc-skip class="author">Christoph
Dieterich, Michael Piechotta</h4>
            
            <h4 data-toc-skip class="date">2023-01-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dieterich-lab/JACUSA2helper/blob/HEAD/vignettes/JACUSA2helper-dart-seq.Rmd" class="external-link"><code>vignettes/JACUSA2helper-dart-seq.Rmd</code></a></small>
      <div class="d-none name"><code>JACUSA2helper-dart-seq.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="an-example-on-dartseq">An example on DARTseq<a class="anchor" aria-label="anchor" href="#an-example-on-dartseq"></a>
</h3>
<p>A complementary genetic approach is an extension of the TRIBE
technique called DART-seq <span class="citation">Meyer (<a href="#ref-Meyer2019" role="doc-biblioref">2019</a>)</span>. Meyer
applied DART-seq on HEK293 cells where the APOBEC domain was fused to
the YTH domain from human YTHDF2 (WT and mutated). In essence, new
C-to-U editing events that are significantly enriched in the YTHDF2-WT,
but not in the binding domain mutant are bona fide candidates for m6A
RNA modification. JACUSA2helper supports the analysis of DARTseq data
too (see below). Input is typically read in via
<code>read_result</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"DARTseq"</span><span class="op">)</span></span>
<span><span class="va">filtered</span> <span class="op">&lt;-</span> <span class="va">DARTseq</span></span>
<span></span>
<span><span class="co"># calculate number of unique base calls per site</span></span>
<span><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu">mcols</span><span class="op">(</span><span class="va">filtered</span><span class="op">)</span><span class="op">[[</span><span class="st">"bc"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">filtered</span><span class="op">$</span><span class="va">bases</span>, <span class="va">Reduce</span>, f <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span>f<span class="op">=</span><span class="st">"+"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/base_count.html">base_count</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">filtered</span> <span class="op">&lt;-</span> <span class="va">filtered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">score</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/All.html">All</a></span><span class="op">(</span><span class="va">cov</span><span class="op">$</span><span class="va">cond1</span> <span class="op">&gt;=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/All.html">All</a></span><span class="op">(</span><span class="va">cov</span><span class="op">$</span><span class="va">cond2</span> <span class="op">&gt;=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bc</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/robust.html">robust</a></span><span class="op">(</span><span class="va">bases</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The above code sequence filters the input to include only sites,
which have a call-2 score higher than 2, a coverage across all
replicates of at least 10. Moreover, the number of distinct base calls
should be less or equal 2 (preferably C and U/T) and the base
substitution should be visible in all replicates of at least one
condition.</p>
<div class="section level4">
<h4 id="some-basic-statistics-on-base-transitions-in-the-data">Some basic statistics on base transitions in the data<a class="anchor" aria-label="anchor" href="#some-basic-statistics-on-base-transitions-in-the-data"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sum base call counts of condition / RNA replicates</span></span>
<span><span class="va">rna_bases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="va">filtered</span><span class="op">$</span><span class="va">bases</span><span class="op">$</span><span class="va">cond2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we don't need lapply_repl, because we don't operate on all replicates from all</span></span>
<span><span class="co"># conditions - only condition 2 / RNA</span></span>
<span><span class="va">ref2YTHmut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/base_sub.html">base_sub</a></span><span class="op">(</span><span class="va">rna_bases</span>, <span class="va">filtered</span><span class="op">$</span><span class="va">ref</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ref2YTHmut</span><span class="op">)</span></span>
<span><span class="co">#&gt; ref2YTHmut</span></span>
<span><span class="co">#&gt;      A-&gt;C      A-&gt;G      A-&gt;T      C-&gt;A      C-&gt;G      C-&gt;T      G-&gt;A      G-&gt;C </span></span>
<span><span class="co">#&gt;         9        47         3         5         7      6243        51        12 </span></span>
<span><span class="co">#&gt;      G-&gt;T no change      T-&gt;A      T-&gt;C      T-&gt;G </span></span>
<span><span class="co">#&gt;         3     12614         2        52         4</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rnaref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="va">filtered</span><span class="op">$</span><span class="va">bases</span><span class="op">$</span><span class="va">cond1</span><span class="op">)</span></span>
<span><span class="va">ref2YTH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/base_sub.html">base_sub</a></span><span class="op">(</span><span class="va">rnaref</span>, <span class="va">filtered</span><span class="op">$</span><span class="va">ref</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ref2YTH</span>, <span class="va">ref2YTHmut</span><span class="op">)</span></span>
<span><span class="co">#&gt;            ref2YTHmut</span></span>
<span><span class="co">#&gt; ref2YTH      A-&gt;C  A-&gt;G  A-&gt;T  C-&gt;A  C-&gt;G  C-&gt;T  G-&gt;A  G-&gt;C  G-&gt;T no change</span></span>
<span><span class="co">#&gt;   A-&gt;C          5     0     0     0     0     0     0     0     0         0</span></span>
<span><span class="co">#&gt;   A-&gt;CT         2     0     0     0     0     0     0     0     0         0</span></span>
<span><span class="co">#&gt;   A-&gt;G          0    44     0     0     0     0     0     0     0         6</span></span>
<span><span class="co">#&gt;   A-&gt;T          0     0     1     0     0     0     0     0     0         1</span></span>
<span><span class="co">#&gt;   C-&gt;A          0     0     0     4     0     0     0     0     0         0</span></span>
<span><span class="co">#&gt;   C-&gt;G          0     0     0     0     7     0     0     0     0         0</span></span>
<span><span class="co">#&gt;   C-&gt;T          0     0     0     0     0  5526     0     0     0     12577</span></span>
<span><span class="co">#&gt;   G-&gt;A          0     0     0     0     0     0    41     0     0        15</span></span>
<span><span class="co">#&gt;   G-&gt;C          0     0     0     0     0     0     0    12     0         0</span></span>
<span><span class="co">#&gt;   G-&gt;T          0     0     0     0     0     0     0     0     3         0</span></span>
<span><span class="co">#&gt;   no change     2     3     2     1     0   717    10     0     0         0</span></span>
<span><span class="co">#&gt;   T-&gt;A          0     0     0     0     0     0     0     0     0         1</span></span>
<span><span class="co">#&gt;   T-&gt;C          0     0     0     0     0     0     0     0     0        14</span></span>
<span><span class="co">#&gt;   T-&gt;G          0     0     0     0     0     0     0     0     0         0</span></span>
<span><span class="co">#&gt;            ref2YTHmut</span></span>
<span><span class="co">#&gt; ref2YTH      T-&gt;A  T-&gt;C  T-&gt;G</span></span>
<span><span class="co">#&gt;   A-&gt;C          0     0     0</span></span>
<span><span class="co">#&gt;   A-&gt;CT         0     0     0</span></span>
<span><span class="co">#&gt;   A-&gt;G          0     0     0</span></span>
<span><span class="co">#&gt;   A-&gt;T          0     0     0</span></span>
<span><span class="co">#&gt;   C-&gt;A          0     0     0</span></span>
<span><span class="co">#&gt;   C-&gt;G          0     0     0</span></span>
<span><span class="co">#&gt;   C-&gt;T          0     0     0</span></span>
<span><span class="co">#&gt;   G-&gt;A          0     0     0</span></span>
<span><span class="co">#&gt;   G-&gt;C          0     0     0</span></span>
<span><span class="co">#&gt;   G-&gt;T          0     0     0</span></span>
<span><span class="co">#&gt;   no change     0    14     0</span></span>
<span><span class="co">#&gt;   T-&gt;A          2     0     0</span></span>
<span><span class="co">#&gt;   T-&gt;C          0    38     0</span></span>
<span><span class="co">#&gt;   T-&gt;G          0     0     4</span></span></code></pre></div>
<p>The following bar plot summarizes the number of sites by
characteristic base substitutions relative to the reference sequence. We
observe a lot more C-to-U transitions in the active YTH binding domain
as compared to the inactivated binding domain.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  base_sub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ref2YTH</span>, <span class="va">ref2YTHmut</span><span class="op">)</span>, </span>
<span>  Source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"YTH"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ref2YTH</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"YTHmut"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ref2YTHmut</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># ggplot requires a data frame</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">base_sub</span>, fill <span class="op">=</span> <span class="va">Source</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Base substitution"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Base substitution"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>   legend.position <span class="op">=</span> <span class="st">"bottom"</span>, </span>
<span>   axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="JACUSA2helper-dart-seq_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="quantitative-assessment-of-tct-frequencies">Quantitative assessment of T/(C+T) frequencies<a class="anchor" aria-label="anchor" href="#quantitative-assessment-of-tct-frequencies"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tempo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lapply_cond.html">lapply_cond</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/lapply_cond.html">lapply_cond</a></span><span class="op">(</span><span class="va">filtered</span><span class="op">$</span><span class="va">bases</span>, <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="va">b</span><span class="op">)</span> <span class="op">}</span> <span class="op">)</span>,</span>
<span>  <span class="va">base_ratio</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu">mcols</span><span class="op">(</span><span class="va">filtered</span><span class="op">)</span><span class="op">[[</span><span class="st">"YTH.t.ratio"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tempo</span><span class="op">$</span><span class="va">cond1</span><span class="op">$</span><span class="cn">T</span></span>
<span><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu">mcols</span><span class="op">(</span><span class="va">filtered</span><span class="op">)</span><span class="op">[[</span><span class="st">"YTHmut.t.ratio"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tempo</span><span class="op">$</span><span class="va">cond2</span><span class="op">$</span><span class="cn">T</span></span>
<span><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu">mcols</span><span class="op">(</span><span class="va">filtered</span><span class="op">)</span><span class="op">[[</span><span class="st">"pred"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>  <span class="va">tempo</span><span class="op">$</span><span class="va">cond1</span><span class="op">$</span><span class="cn">T</span> <span class="op">&gt;</span> <span class="va">tempo</span><span class="op">$</span><span class="va">cond2</span><span class="op">$</span><span class="cn">T</span>, </span>
<span>  <span class="st">"Positives"</span>, </span>
<span>  <span class="st">"Negatives"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The following scatter plot summarizes the T/(C+T) frequencies and
labels them.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu">mcols</span><span class="op">(</span><span class="va">filtered</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YTHmut.t.ratio"</span>, <span class="st">"YTH.t.ratio"</span>, <span class="st">"pred"</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">YTHmut.t.ratio</span>, y<span class="op">=</span><span class="va">YTH.t.ratio</span>, color<span class="op">=</span><span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Mutated YTH binding domain (T/(C+T))"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Active YTH binding domain (T/(C+T))"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#999999'</span>, <span class="st">'#E69F00'</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">0.8</span>, y<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">"Negatives"</span>, color<span class="op">=</span><span class="st">"#999999"</span>, size<span class="op">=</span><span class="fl">6</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">0.25</span>, y<span class="op">=</span><span class="fl">0.8</span>, label<span class="op">=</span><span class="st">"Positives"</span>, color<span class="op">=</span><span class="st">"#E69F00"</span>, size<span class="op">=</span><span class="fl">6</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="JACUSA2helper-dart-seq_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Meyer2019" class="csl-entry">
Meyer, Kate D. 2019. <span>“<span>DART</span>-Seq: An Antibody-Free
Method for Global m6A Detection.”</span> <em>Nature Methods</em> 16
(12): 1275–80. <a href="https://doi.org/10.1038/s41592-019-0570-0" class="external-link">https://doi.org/10.1038/s41592-019-0570-0</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Piechotta, <a href="http://dieterichlab.org/" class="external-link">Dieterich Lab</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
